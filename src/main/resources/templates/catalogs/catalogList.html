<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>
        To Do List
    </title>
    <link rel="stylesheet" href="styles/kendo.common.min.css"/>
    <link rel="stylesheet" href="styles/kendo.default-v2.min.css"/>
    <link rel="stylesheet" href="styles/kendo.default.mobile.min.css"/>
    <script src="js/jquery.min.js"></script>
    <script src="js/kendo.all.min.js"></script>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link th:href="@{/css/style.css}" rel="stylesheet"/>
    <!--    <script src="/js/jquery-3.5.1.min.js"></script>-->
</head>

<body>
<div class="container">
    <h1><a href="/" style="text-decoration: none">To Do List</a></h1>

    <div id="totalelements">총 리스트 개수 : <span th:text="${catalogs.totalElements}"></span></div>
    <div class="text-right">
        <form name="form1" action="/" method="POST">
            <div id="Panel"></div>
            <div>
                <input id="inputBtn" class="btn btn-primary" value="등록" type="button" onclick="
            if(this.id === 'inputBtn'){
                showRegisterForm();
                this.id = 'registerBtn';
            }else{
                   insertContent();
                   this.id = 'inputBtn';
                   }
">
            </div>
        </form>
        <div id="grid"></div>
        <script>
            $(document).ready(function () {
                var dataSource = new kendo.data.DataSource({
                    transport: {
                        read: {
                            url: "/read",
                            type: "POST",
                            dataType: "json",
                            contentType: "application/json"
                        },
                        update: {
                            url: "/update",
                            type: "POST",
                            dataType: "json",
                            contentType: "application/json"
                        },
                        destroy: {
                            url: "/delete",
                            type: "POST",
                            dataType: "json",
                            contentType: "application/json"
                        },
                        create: {
                            url: "/create",
                            type: "POST",
                            dataType: "json",
                            contentType: "application/json"
                        },
                        parameterMap: function(options, operation) {
                            if (operation !== "read" && options.models) {
                                console.log(JSON.stringify(options));
                                return JSON.stringify(options);
                            }
                        }
                    },
                    batch: true,
                    pageSize: 10,
                    schema: {
                        model: {
                            id: "id",
                            fields: {
                                title: {validation: {required: true}},
                                content: {validation: {required: true}},
                                this_date: {validation: {required: true}}
                            }
                        }
                    },
                });
                $("#grid").kendoGrid({
                    dataSource: dataSource,
                    pageable: true,
                    sortable: true,
                    toolbar: ["create"],
                    columns: [
                        {
                            field: "title",
                            title: "제목"
                        },
                        {
                            field: "content",
                            title: "내용"
                        },
                        {
                            field: "this_date",
                            title: "날짜",
                            // format: "{0:dd-MM-yyyy}"
                        },
                        {
                            command: ["edit", "destroy"], title: "&nbsp;"
                        }],
                    editable: "inline"
                });
                console.log(dataSource);
            });
        </script>
    </div>
</div>
</body>
</html>